Link: https://tryhackme.com/room/malware-sandbox-aoc2025-SD1zn4fZQt

**Task 1: Introduction**

Read the content and start the machine

**Task 2: Malware Analysis Using Sandboxes**

**Answer the questions below**

1. _**Static analysis: What is the SHA256Sum of the HopHelper.exe?**_

Answer: **`F29C270068F865EF4A747E2683BFA07667BF64E768B38FBB9A2750A3D879CA33`**

**Explanation:**

We open PEStudio 

<img width="718" height="530" alt="image" src="https://github.com/user-attachments/assets/38f29c97-7b53-46c9-9d25-adaacd4b145f" />

And from the PEStudio, we open HopHelper.exe

<img width="828" height="632" alt="Screenshot 2025-12-08 112834" src="https://github.com/user-attachments/assets/178cd5cf-71d2-4791-b092-78f4d68c138b" />

And we can see the SHA256Sum hash as

<img width="1919" height="764" alt="Screenshot 2025-12-08 112950" src="https://github.com/user-attachments/assets/b4f17f33-d1b7-4d01-b238-aae551592b80" />

______________________________________________

2. _**Static analysis: Within the strings of HopHelper.exe, a flag with the format THM{XXXXX} exists. What is that flag value?**_

Note, this can be found towards the bottom of the strings output.

Answer: **`THM{STRINGS_FOUND}`**

**Explanation:**

We select "Strings" from the left pane and scroll to the bottom to see the flag

<img width="1918" height="767" alt="Screenshot 2025-12-08 113225" src="https://github.com/user-attachments/assets/8233fe5e-05d3-4903-9bf2-6eb9b84dea41" />

________________________________________________

3. **_Dynamic analysis: What registry value has the HopHelper.exe modified for persistence?_**

Note: Provide the full path of the key that has been modified

Answer: **`HKU\S-1-5-21-1966530601-3185510712-10604624-1008\Software\Microsoft\Windows\CurrentVersion\Run\HopHelper`**

**Explanation:**

We open Regshot and click on Shot 1 and then Shot

<img width="547" height="402" alt="Screenshot 2025-12-08 114446" src="https://github.com/user-attachments/assets/75293c60-151c-4171-9f31-50269212051e" />

Once done, we will be on second shot

<img width="399" height="398" alt="Screenshot 2025-12-08 115252" src="https://github.com/user-attachments/assets/7939cadd-c524-4100-bd30-980dc0fa63b1" />

Now run the HopHelper 

<img width="1551" height="761" alt="Screenshot 2025-12-08 115343" src="https://github.com/user-attachments/assets/6dd7cfb4-4b29-4fed-b053-cdcdb56fa6f6" />

<img width="617" height="437" alt="Screenshot 2025-12-08 115402" src="https://github.com/user-attachments/assets/0728c65b-0e7b-4647-a052-20dc4148aaa8" />

Now select Shot 2 and click Shot

<img width="539" height="408" alt="Screenshot 2025-12-08 115448" src="https://github.com/user-attachments/assets/80e2ce7f-8c2c-431f-9c6a-9912eca9a417" />

Once done, we click on Compare

<img width="400" height="407" alt="Screenshot 2025-12-08 120535" src="https://github.com/user-attachments/assets/514ed00e-e00a-48da-b23e-174f2bf4ef7b" />

When the comparison is done, we will be shown an output file as shown below

<img width="896" height="701" alt="Screenshot 2025-12-08 124232" src="https://github.com/user-attachments/assets/508f843a-c967-4e25-aafb-4e63228ac359" />

And we will see the registry value as 

<img width="1897" height="182" alt="image" src="https://github.com/user-attachments/assets/8caea76d-5df9-458c-84ba-1540795f1a25" />


_______________________________________________

4. _**Dynamic analysis: Filter the output of ProcMon for "TCP" operations. What network protocol is HopHelper.exe using to communicate?**_

Answer: **`http`**

**Explanation:**

We open Procmon and then run the HopHelper

<img width="1908" height="767" alt="Screenshot 2025-12-08 130442" src="https://github.com/user-attachments/assets/70ef1b1e-12f2-49bf-b2d1-75ac1c411f6e" />

<img width="1551" height="761" alt="Screenshot 2025-12-08 115343" src="https://github.com/user-attachments/assets/8ded410f-9d41-4a85-957a-9a0dbf93bd79" />

<img width="344" height="200" alt="1" src="https://github.com/user-attachments/assets/966bfc43-781d-4a9a-99ae-92656feeecfb" />

Now we will create the following filter and see the network proctol being used

<img width="810" height="496" alt="Screenshot 2025-12-08 125339" src="https://github.com/user-attachments/assets/6aa3b292-d93f-4f65-9d4b-e406cfe09b30" />

<img width="992" height="213" alt="Screenshot 2025-12-08 130804" src="https://github.com/user-attachments/assets/42a56adc-3baa-4b05-be76-5263c9d51aee" />

<img width="1042" height="601" alt="Screenshot 2025-12-08 130840" src="https://github.com/user-attachments/assets/07934098-9de1-4e45-b3a8-b6d5a6ad2a0d" />

_________________________________________________

5. _**Bonus: Can you find the web panel that HopHelper.exe is communicating with?**_

Answer: No answer needed

**Explanation:**

From the previous exercise we could see the web panel info

<img width="1041" height="759" alt="Screenshot 2025-12-08 131503" src="https://github.com/user-attachments/assets/68e0ee65-45c7-4f22-b403-0707a85ba02e" />

<img width="1919" height="753" alt="Screenshot 2025-12-08 131841" src="https://github.com/user-attachments/assets/b724d8bb-0738-4902-a7d4-b1ab32775745" />

_________________________________________________________

6. **_If you enjoyed today's room, feel free to explore both the Basic Static Analysis and Basic Dynamic Analysis rooms, where you can delve deeper into the techniques and tools discussed today._**

Answer: No answer needed

_________________________________________________________
